import{__awaiter as t,__generator as n}from"tslib";import{INIT_FAILED as i}from"@liff/consts";import{createLiffError as e}from"@liff/util";import{fetch as r}from"@liff/server-api";var o=navigator.language,s=null;function a(i){return t(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return o=i,[4,c()];case 1:return t.sent(),[2]}}))}))}function c(){return t(this,void 0,void 0,(function(){var t,i;return n(this,(function(n){switch(n.label){case 0:return[4,r("".concat("https://liffsdk.line-scdn.net/xlt/manifest.json"),{method:"GET",headers:{Accept:"application/json"}})];case 1:return t=n.sent(),i="".concat(o),!t.languages[i]&&o.includes("-")&&(i=o.split("-")[0]),t.languages[i]||(i="en"),[4,r("".concat("https://liffsdk.line-scdn.net/xlt","/").concat(t.languages[i]),{method:"GET",headers:{Accept:"application/json"}})];case 2:return s=n.sent(),[2]}}))}))}function l(t){if(null===s)throw e(i,"please call xlt after liff.init");return s[t]}var u=new(function(){function i(){this.name="i18n"}return i.prototype.install=function(t){return t.internalHooks.init.beforeFinished(this.beforeInitFinished.bind(this)),{setLang:a}},i.prototype.beforeInitFinished=function(){return t(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,c()];case 1:return t.sent(),[2]}}))}))},i}());export{u as module,l as t};
