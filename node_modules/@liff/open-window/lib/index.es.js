import{__read as n}from"tslib";import{INVALID_ARGUMENT as i}from"@liff/consts";import{createLiffError as o,compareVersion as t}from"@liff/util";import{isInClient as e}from"@liff/is-in-client";import{getOS as f}from"@liff/get-os";import{getLineVersion as r}from"@liff/get-line-version";import{call as l}from"@liff/native-bridge";var c=function(n,i){return n?"&".concat(n.split("&").filter((function(n){return-1===n.indexOf("is_liff_external_open_window")})).join("&").concat("".concat(i?"#".concat(i):""))):"".concat(i?"#".concat(i):"")};function a(a){if(!function(i){if(!i||"object"!=typeof i)return!1;var o=i,t=o.url,e=o.external,f=n([typeof t,typeof e],2),r=f[0],l=f[1];return"string"===r&&""!==t&&("undefined"===l||"boolean"===l)}(a))throw o(i,"Invalid parameters for liff.openWindow()");var p=r();if(e())if(null!==p&&"ios"===f()&&t(p,"9.19")>=0||!window._liff.postMessage){var d=a.url,s=a.external,u=void 0!==s&&s;window.open(function(i,o){var t,e,f,r,l,a,p,d,s;(function(n){return-1!==n.indexOf("#")&&-1!==n.indexOf("?")&&n.indexOf("#")<n.indexOf("?")})(i)||function(n){return-1===n.indexOf("?")&&-1!==n.indexOf("#")}(i)?(p=(t=n(i.split("#"),2))[0],e=t[1],d=(f=n((void 0===e?"":e).split("?"),2))[0],s=f[1]):(p=(r=n(i.split("?"),2))[0],l=r[1],s=(a=n((void 0===l?"":l).split("#"),2))[0],d=a[1]);var u=c(s,d);return"".concat(p,"?").concat("is_liff_external_open_window","=").concat(!!o).concat(u)}(d,u))}else l("openWindow",a);else window.open(a.url,"_blank")}export{a as openWindow};
